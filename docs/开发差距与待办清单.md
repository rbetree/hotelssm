## 1. 目的

本文档基于课堂需求文档 `class/j2ee-ssm系统需求设计.md` 与课程设计报告要求 `class/设计报告要求.md`，
对当前仓库代码进行对照盘点，明确“已实现/未实现/需补齐”的开发清单，便于后续编码与撰写设计报告。

## 2. 当前已实现的主要功能（按模块归类）

### 2.1 前台（顾客/会员）

- 客房/房型浏览：`src/com/ischoolbar/programmer/controller/home/HomeController.java`
- 注册/登录/退出：`src/com/ischoolbar/programmer/controller/home/HomeController.java`
- 会员中心（查看个人订单列表、修改个人信息、修改密码）：`src/com/ischoolbar/programmer/controller/home/HomeAccountController.java`
- 在线预订（登录后下单）：`src/com/ischoolbar/programmer/controller/home/HomeAccountController.java`（`/home/account/book_order`）

### 2.2 后台（员工/管理员）

后台登录、菜单、角色、用户、权限（按菜单授权）：`src/com/ischoolbar/programmer/controller/admin/SystemController.java` 及 `admin/*Controller.java`

- 订单（预定）管理：`src/com/ischoolbar/programmer/controller/admin/BookOrderController.java`
  - 支持新增/编辑/删除/查询预定单（页面：`WebContent/WEB-INF/views/book_order/list.jsp`）
- 入住管理：`src/com/ischoolbar/programmer/controller/admin/CheckinController.java`
- 客房与基础数据：房间/房型/楼层/客户信息等后台管理（`admin/RoomController`、`admin/RoomTypeController`、`admin/FloorController`、`admin/AccountController`）
- 系统日志：`src/com/ischoolbar/programmer/controller/admin/LogController.java`
- 营业统计（图表）：`src/com/ischoolbar/programmer/controller/admin/StatsController.java`

### 2.3 数据库（已有表）

当前初始化脚本：`db_hotel_ssm.sql`，主要表包括：

- 用户/权限：`user`、`role`、`menu`、`authority`、`log`
- 业务：`room_type`、`room`、`floor`、`account`、`book_order`、`checkin`

## 3. 与课堂需求的差距（需要补充开发）

下面按 `class/j2ee-ssm系统需求设计.md` 的功能点逐项对照。

### 3.1 预订功能（B1~B6）

- ✅ B1 浏览客房信息：已实现（前台房型列表）
- ✅ B2 在线预订：已支持游客直接预订（未登录时自动创建账号并登录：用户名=手机号，初始密码=身份证后6位）
- ✅ B3 取消预订（顾客侧）：已实现（“我的订单”可取消预定中订单，并回滚房型可用数/预定数）
- ✅ B4 修改预订（顾客侧）：已实现（“我的订单”可修改预定中订单：日期/房型/联系人信息等）
- ✅ B5 查询订单：已增强（支持按状态/房型/日期筛选，并补齐“已取消”等状态解释）
- ❌ B6 查看活动：本次不实现（按任务要求无需实现）

建议开发任务：

1. 前台新增“我的订单”操作：取消预订、修改预订（改日期/房型/联系人信息等）✅（已完成）
2. 预订状态模型补齐：至少区分“待确认/已确认/已取消/已入住/已完成”
3. 活动模块（见 3.3）完成后，前台首页展示活动列表/详情
4. 如需满足“游客可预订”：支持未登录下单（或引导游客一键注册后下单），并在报告中说明取舍 ✅（已完成）

### 3.2 会员功能（C1~C5）

- ✅ C1 用户注册：已实现
- ✅ C2 会员登录：已实现
- ⚠️ C5 个人信息管理：已实现（修改资料/密码）
- ❌ C3 积分管理：未实现（数据库与代码缺少积分字段与累积逻辑）
- ❌ C4 会员等级查看：未实现（数据库与代码缺少等级字段与升级逻辑）
- ❌ 会员等级折扣（九折/八折）：未实现（下单价格未按等级计算）

建议开发任务（两种落地方案二选一即可，建议方案 A）：

- 方案 A（推荐）：在现有 `account` 上扩展字段
  - 增加 `points`（积分）、`level`（等级）字段
  - 下单/入住结算后累积积分并自动升级
  - 下单时按 `level` 计算折扣价（0.9/0.8）
- 方案 B：新增独立 `member` 表（与 `account` 关联）
  - 需要同步改 Mapper/Service/页面，改动范围更大

### 3.3 酒店活动公布（ACTIVITY）

需求要求“系统首页展示活动”，当前缺少：

- 活动表结构
- 活动管理后台（新增/编辑/上下架）
- 活动前台展示页面

建议开发任务：

1. 新增 `activity` 表（标题、内容、开始/结束时间、状态、目标等级等）
2. 新增后台管理：`/admin/activity/*`（列表/新增/编辑/删除/上下架）
3. 新增前台展示：首页活动区 + 活动详情页

### 3.4 员工系统（D1~D5）

- ✅ D1 员工登录：已实现（后台系统登录）
- ✅ D2 创建订单：后台预定管理支持新增预定单
- ⚠️ D3 订单管理：已实现增删改查，但缺少“确认订单”这种明确动作（需求中强调对新订单确认）
- ⚠️ D4 客房状态维护：已有房间/入住管理，但状态模型与需求文档（空闲/已预订/已入住/清洁中/维修中）需要统一
- ⚠️ D5 客户信息查询：后台存在客户（`account`）管理，可进一步补齐查询维度与关联订单视图

建议开发任务：

1. 新增“确认订单”动作（例如把 `book_order.status` 从“待确认”改为“已确认”）
2. 统一状态枚举与页面展示文案，保证“预订→确认→入住→离店/取消”闭环

### 3.5 管理功能（E1~E4）

- ✅ E1 员工账户管理：以后台 `user/role/menu/authority` 体系实现（可视为员工权限管理）
- ✅ E2 客房信息管理：已实现（房间/房型/楼层）
- ⚠️ E3 房型价格设置：房型管理已具备字段，但需确认前台展示/下单使用的价格字段一致
- ⚠️ E4 系统监控：当前有日志与统计，但“监控”可在报告中定义为：
  - 登录日志/操作日志（已有 `log`）
  - 营业统计（已有 `stats`）
  - 关键异常与告警（可选增强）

## 4. 与设计报告要求相关的“必须补齐项”

`class/设计报告要求.md` 里要求报告内容最终要能对应到实现代码，建议额外补齐：

1. 数据库设计一致性
   - 课堂需求文档里的 E-R 与本项目实际表结构目前不一致（缺少 MEMBER/ACTIVITY/积分/等级）
   - 需要“补齐表结构”或“同步修订需求文档/报告中的数据库设计”
2. 主要业务流程图（建议至少 1 个）
   - 在线预订流程（含折扣/积分/确认/取消）
3. 核心功能代码截图与说明
   - Controller/Service/Mapper 三层调用链 + 关键 SQL

## 5. 推荐开发优先级（按最小闭环）

P0（必须，优先完成）：

1. 订单取消（顾客侧）+ 后台状态联动（房型/房间可用数恢复）
2. 订单修改（顾客侧）+ 后台可追溯（修改前后信息）
3. 会员积分/等级/折扣（至少实现九折/八折规则）

P1（建议完成）：

1. 活动模块（后台发布 + 前台展示）
2. 明确的订单确认动作（员工侧）

P2（可选加分）：

1. 忘记密码/重置密码
2. 更完善的系统监控（异常告警、操作审计更细）

