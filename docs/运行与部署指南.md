## 1. 运行环境

- JDK：1.8+
- Tomcat：8.5 / 9（推荐 8.5+）
- MySQL：5.7（其他版本可自行适配）

## 2. 数据库初始化

1. 创建数据库（默认库名：`db_hotel_ssm`）。
2. 导入脚本：`db_hotel_ssm.sql`

示例（命令行）：

```bash
mysql -uroot -p -e "CREATE DATABASE IF NOT EXISTS db_hotel_ssm DEFAULT CHARACTER SET utf8;"
# 显式指定 UTF-8，避免中文数据“å…”乱码
mysql --default-character-set=utf8 -uroot -p db_hotel_ssm < db_hotel_ssm.sql
```

## 3. 修改数据库配置

配置文件位置：`src/config/db.properties`

你至少需要确认以下配置正确：

- `datasource.connection.url`
- `datasource.connection.username`
- `datasource.connection.password`

## 4. Tomcat 部署与启动（IDEA 推荐）

### 4.1 使用 IDEA（中文）

1. `文件 -> 打开` 选择项目根目录（包含 `WebContent/` 与 `src/` 的那一层）。
2. `运行 -> 编辑配置... -> + -> Tomcat 服务器 -> 本地`
3. `部署` 里添加 Artifact（或直接选择该项目作为 Web 应用进行部署）
4. `应用程序上下文` 建议设为 `/`（或按需设置为 `/hotelssm`）
5. 启动 Tomcat 后，在浏览器访问对应路径。

### 4.2 手动部署（不使用 IDEA）

思路：

- 将项目打成 `war` 或按“Exploded”方式部署到 Tomcat 的 `webapps/`
- 启动 Tomcat，访问应用上下文

由于该项目当前不是 Maven 工程，具体打包方式与 IDE/环境相关，建议优先使用 IDEA 的 Tomcat 运行配置。

## 4.3 命令行启动（Maven + Jetty，可选）

> 适用场景：不依赖 IDE，想在命令行快速“跑通原项目”。仓库已补充 `pom.xml`，将传统目录结构映射为 Maven `war` 工程，并提供 Jetty 启动方式。
> 注意：现有 Java 源码文件编码为 **GBK**，`pom.xml` 已按 GBK 配置编译编码（否则会出现 `unmappable character` 编译错误）。

1. 确保本机已安装 JDK 与 Maven（或使用自备工具链）。
2. 确保 MySQL 已启动并导入脚本（也可用 Docker 一键初始化）：

```bash
docker rm -f hotelssm-mysql >/dev/null 2>&1 || true

docker run --name hotelssm-mysql \
  -e MYSQL_ROOT_PASSWORD=123456 \
  -e MYSQL_DATABASE=db_hotel_ssm \
  -p 3306:3306 \
  -d mysql:5.7 \
  --character-set-server=utf8 --collation-server=utf8_general_ci
```

然后导入脚本（显式指定 UTF-8，避免中文数据“å…”乱码）：

```bash
docker exec -i hotelssm-mysql mysql --default-character-set=utf8 -uroot -p123456 db_hotel_ssm < db_hotel_ssm.sql
```

3. 构建并启动：

```bash
mvn -DskipTests package
mvn -DskipTests jetty:run
```

4. 访问入口同上文（默认端口 8080）。

## 5. 访问入口（路由）

以下为常用入口（以应用上下文为 `/` 举例）：

- 前台首页：`/home/index`
- 前台登录：`/home/login`
- 前台注册：`/home/reg`
- 后台登录：`/system/login`

## 5.1 默认账号（来自初始化脚本）

数据库脚本 `db_hotel_ssm.sql` 内置了部分测试数据，常用默认账号如下：

- 后台管理员：用户名 `admin`，密码 `admin`
- 前台用户示例：用户名 `猿来入此`，密码 `123456`（更多见 `account` 表数据）

如需自行重置账号，请直接修改数据库对应表数据或在系统内创建。

## 6. 关键配置位置速查

- Web 入口：`WebContent/WEB-INF/web.xml`
  - Spring 容器：`classpath:config/spring/applicationContext.xml`
  - Spring MVC：`classpath:config/springmvc/springmvc.xml`
- Spring：`src/config/spring/applicationContext.xml`
- Spring MVC：`src/config/springmvc/springmvc.xml`
- MyBatis：`src/config/mybatis/mybatis-config.xml` 与 `src/config/mybatis/mapper/**`
- 日志：`src/config/log4j.properties`

## 7. 常见问题排查

1. 页面 404
   - 检查 Tomcat 是否部署成功、应用上下文是否正确
   - 检查 `web.xml` 中 `DispatcherServlet` 映射是否为 `/`
2. 数据库连接失败
   - 检查 `src/config/db.properties` 的 URL/用户名/密码
   - 确认 MySQL 端口与库名正确（默认 `db_hotel_ssm`）
3. 数据库数据中文乱码（页面出现“å…”这类字符）
   - 常见原因：`db_hotel_ssm.sql` 是 UTF-8，但导入时 MySQL 客户端连接字符集为 latin1，导致中文被错误转码写入
   - 建议做法：
     - 重新导入时显式指定 UTF-8：`mysql --default-character-set=utf8 db_hotel_ssm < db_hotel_ssm.sql`
     - 或使用 Docker 时，在容器内导入并指定字符集：`docker exec -i hotelssm-mysql mysql --default-character-set=utf8 -uroot -p123456 db_hotel_ssm < db_hotel_ssm.sql`
4. 数据库里中文正常，但页面/接口显示“å…”（读取阶段乱码）
   - 现象：用 `mysql` 直接查询“看起来”是中文，但系统页面动态数据变成“å…”
   - 排查建议：用 `HEX()` 判断数据是否已经在导入时写坏（若 `HEX(name)` 类似 `C3A5...`，说明已错误转码写入）
     - 示例：`SELECT name, HEX(name) FROM room_type LIMIT 1;`
   - 处理方式：如果已写坏，按上面的第 3 条“重新导入并显式指定 UTF-8”修复
5. 中文乱码
   - `web.xml` 已配置 `CharacterEncodingFilter`，仍乱码时检查 JSP 编码与浏览器缓存
